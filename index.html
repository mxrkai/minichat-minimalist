<html><head><base href="https://websimgpt.com">
<title>Neuro.AI - OpenAI Integrated Chat Interface</title>
<style>
  :root {
    --bg-color: #e0e5ec;
    --text-color: #333;
    --shadow-color: #babecc;
    --highlight-color: #ffffff;
    --accent-color: #6b7280;
    --primary-color: #4a90e2;
  }
  body {
    font-family: 'Arial', sans-serif;
    background-color: var(--bg-color);
    color: var(--text-color);
    margin: 0;
    padding: 0;
    display: flex;
    flex-direction: column;
    height: 100vh;
    overflow: hidden;
    transition: all 0.3s ease;
  }
  .neuro-box {
    border-radius: 15px;
    background: var(--bg-color);
    box-shadow: 5px 5px 10px var(--shadow-color), 
                -5px -5px 10px var(--highlight-color);
  }
  .neuro-inset {
    border-radius: 15px;
    background: var(--bg-color);
    box-shadow: inset 5px 5px 10px var(--shadow-color), 
                inset -5px -5px 10px var(--highlight-color);
  }
  #main-content {
    display: flex;
    flex-direction: column;
    height: 100vh;
    padding: 0 20px;
  }
  #conversation-tabs {
    display: flex;
    justify-content: space-around;
    margin-bottom: 20px;
  }
  .tab-btn {
    flex: 1;
    padding: 10px;
    border: none;
    background: none;
    font-weight: bold;
    cursor: pointer;
    transition: all 0.3s ease;
  }
  .tab-btn.active {
    box-shadow: inset 3px 3px 5px var(--shadow-color), 
                inset -3px -3px 5px var(--highlight-color);
  }
  #conversations-container {
    flex-grow: 1;
    overflow-y: auto;
    margin-bottom: 100px;
  }
  .conversation {
    display: none;
  }
  .conversation.active {
    display: flex;
    flex-direction: column;
  }
  #previous-conversations {
    padding: 20px;
  }
  .previous-conversation-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding-right: 10px;
  }
  .previous-conversation-item {
    padding: 15px;
    margin-bottom: 10px;
    cursor: pointer;
  }
  .previous-conversation-item:hover {
    box-shadow: 0 0 10px var(--shadow-color);
  }
  #chat-container {
    flex-grow: 1;
    overflow-y: auto;
    padding: 20px;
    margin-bottom: 50px;
    display: flex;
    flex-direction: column;
  }
  .chat-bubble {
    max-width: 70%;
    padding: 15px;
    margin: 10px;
    position: relative;
  }
  .user-bubble {
    align-self: flex-end;
  }
  .ai-bubble {
    align-self: flex-start;
  }
  .chat-header {
    display: flex;
    align-items: center;
    margin-bottom: 10px;
  }
  .chat-icon {
    width: 30px;
    height: 30px;
    border-radius: 50%;
    margin-right: 10px;
    background-size: cover;
  }
  .chat-name {
    font-weight: bold;
  }
  #input-container {
    display: flex;
    padding: 10px;
    position: fixed;
    bottom: 0;
    left: 0;
    right: 0;
    z-index: 100;
  }
  #user-input {
    flex-grow: 1;
    padding: 10px;
    border: none;
    margin-right: 10px;
  }
  #send-btn, #role-btn, #save-prompt-btn {
    border: none;
    color: var(--text-color);
    padding: 10px 20px;
    text-align: center;
    text-decoration: none;
    display: inline-block;
    font-size: 16px;
    cursor: pointer;
    font-weight: bold;
  }
  #role-btn {
    margin-right: 10px;
  }
  button:active {
    box-shadow: inset 3px 3px 5px var(--shadow-color), 
                inset -3px -3px 5px var(--highlight-color);
  }
  body.dark-mode {
    --bg-color: #1a1a1a;
    --text-color: #e0e0e0;
    --shadow-color: #000000;
    --highlight-color: #2a2a2a;
    --accent-color: #4a4a4a;
  }
  #upper-panel {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 10px;
    margin-bottom: 20px;
  }
  .icon-grid {
    display: flex;
    gap: 10px;
  }
  .icon-button {
    width: 40px;
    height: 40px;
    display: flex;
    justify-content: center;
    align-items: center;
    cursor: pointer;
    transition: all 0.3s ease;
  }
  .icon-button:hover {
    transform: scale(1.1);
  }
  .icon-button svg {
    width: 24px;
    height: 24px;
    fill: var(--text-color);
  }
  .tab-icon {
    width: 40px;
    height: 40px;
    display: flex;
    justify-content: center;
    align-items: center;
    cursor: pointer;
    transition: all 0.3s ease;
  }
  .tab-icon.active {
    box-shadow: inset 3px 3px 5px var(--shadow-color), 
                inset -3px -3px 5px var(--highlight-color);
  }
  .tab-icon svg {
    width: 24px;
    height: 24px;
    fill: var(--text-color);
  }
  #settings-modal {
    display: none;
    position: fixed;
    z-index: 1000;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    overflow: auto;
    background-color: rgba(0,0,0,0.4);
  }
  .modal-content {
    background-color: var(--bg-color);
    margin: 15% auto;
    padding: 20px;
    border-radius: 15px;
    width: 80%;
    max-width: 500px;
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
  }
  .close {
    color: var(--text-color);
    float: right;
    font-size: 28px;
    font-weight: bold;
    cursor: pointer;
  }
  .close:hover,
  .close:focus {
    color: var(--accent-color);
    text-decoration: none;
    cursor: pointer;
  }
  .settings-form {
    display: flex;
    flex-direction: column;
    gap: 15px;
  }
  .settings-form label {
    font-weight: bold;
  }
  .settings-form input,
  .settings-form select {
    padding: 10px;
    border-radius: 5px;
    border: none;
    background-color: var(--highlight-color);
    color: var(--text-color);
  }
  .settings-form button {
    padding: 10px;
    border: none;
    border-radius: 5px;
    background-color: var(--primary-color);
    color: white;
    cursor: pointer;
    font-weight: bold;
  }
  .settings-form button:hover {
    background-color: var(--accent-color);
  }
  .message-content {
    line-height: 1.5;
  }
  .message-content p {
    margin-bottom: 10px;
  }
  .message-content h1, .message-content h2, .message-content h3, 
  .message-content h4, .message-content h5, .message-content h6 {
    margin-top: 15px;
    margin-bottom: 10px;
  }
  .message-content ul, .message-content ol {
    margin-left: 20px;
    margin-bottom: 10px;
  }
  .message-content pre {
    background-color: var(--accent-color);
    padding: 10px;
    border-radius: 5px;
    overflow-x: auto;
  }
  .message-content code {
    font-family: 'Courier New', Courier, monospace;
    background-color: var(--accent-color);
    padding: 2px 4px;
    border-radius: 3px;
  }
  .message-content blockquote {
    border-left: 3px solid var(--primary-color);
    padding-left: 10px;
    margin-left: 0;
    color: var(--accent-color);
  }
  @media (max-width: 768px) {
    #main-content {
      padding: 0 10px;
    }
    
    #upper-panel {
      flex-wrap: wrap;
      justify-content: center;
    }
    
    .icon-grid {
      margin-bottom: 10px;
    }
    
    #input-container {
      flex-direction: column;
      padding: 10px;
    }
    
    #role-btn, #user-input, #send-btn, #save-prompt-btn {
      width: 100%;
      margin-bottom: 10px;
    }
    
    #user-input {
      margin-right: 0;
    }
    
    .chat-bubble {
      max-width: 90%;
    }
    
    .modal-content {
      width: 90%;
      margin: 10% auto;
    }
  }
  .icon-button, .tab-icon {
    width: 36px;
    height: 36px;
  }
  .icon-button svg, .tab-icon svg {
    width: 20px;
    height: 20px;
  }
  #conversations-container {
    margin-bottom: 80px;
  }
  #input-container {
    padding: 10px;
  }
  .prompt-dropdown {
    display: none;
    position: absolute;
    background-color: var(--bg-color);
    min-width: 160px;
    box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
    z-index: 1;
    max-height: 200px;
    overflow-y: auto;
  }
  .prompt-dropdown div {
    color: var(--text-color);
    padding: 12px 16px;
    text-decoration: none;
    display: block;
    cursor: pointer;
  }
  .prompt-dropdown div:hover {
    background-color: var(--accent-color);
  }
  .copy-icon {
    position: absolute;
    top: 5px;
    right: 5px;
    cursor: pointer;
    opacity: 0.6;
    transition: opacity 0.3s;
  }
  .copy-icon:hover {
    opacity: 1;
  }
  .delete-icon {
    cursor: pointer;
    opacity: 0.6;
    transition: opacity 0.3s;
  }
  .delete-icon:hover {
    opacity: 1;
  }
  .delete-icon svg {
    width: 20px;
    height: 20px;
    fill: var(--text-color);
  }
  .rename-icon {
    cursor: pointer;
    opacity: 0.6;
    transition: opacity 0.3s;
    margin-right: 5px;
  }
  .rename-icon:hover {
    opacity: 1;
  }
  .rename-icon svg {
    width: 20px;
    height: 20px;
    fill: var(--text-color);
  }
</style>
<script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
</head>
<body>
  <div id="main-content">
    <div id="upper-panel" class="neuro-box">
      <div class="icon-grid">
        <div class="icon-button neuro-box" id="home-btn">
          <svg viewBox="0 0 24 24"><path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"/></svg>
        </div>
        <div class="icon-button neuro-box" id="new-conversation-btn">
          <svg viewBox="0 0 24 24"><path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/></svg>
        </div>
        <div class="tab-icon neuro-box active" id="current-tab">
          <svg viewBox="0 0 24 24"><path d="M3 13h2v-2H3v2zm0 4h2v-2H3v2zm0-8h2V7H3v2zm4 4h14v-2H7v2zm0 4h14v-2H7v2zM7 7v2h14V7H7z"/></svg>
        </div>
        <div class="tab-icon neuro-box" id="previous-tab">
          <svg viewBox="0 0 24 24"><path d="M3 13h2v-2H3v2zm0 4h2v-2H3v2zm0-8h2V7H3v2zm4 4h14v-2H7v2zm0 4h14v-2H7v2zM7 7v2h14V7H7zm-4 6h2v-2H3v2zm0 4h2v-2H3v2zm0-8h2V7H3v2z"/></svg>
        </div>
      </div>
      <div class="icon-grid">
        <div class="icon-button neuro-box" id="clear-conversation-btn">
          <svg viewBox="0 0 24 24"><path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"/></svg>
        </div>
        <div class="icon-button neuro-box" id="settings-btn">
          <svg viewBox="0 0 24 24"><path d="M19.14,12.94c0.04-0.3,0.06-0.61,0.06-0.94c0-0.32-0.02-0.64-0.07-0.94l2.03-1.58c0.18-0.14,0.23-0.41,0.12-0.61 l-1.92-3.32c-0.12-0.22-0.37-0.29-0.59-0.22l-2.39,0.96c-0.5-0.38-1.03-0.7-1.62-0.94L14.4,2.81c-0.04-0.24-0.24-0.41-0.48-0.41 h-3.84c-0.24,0-0.43,0.17-0.47,0.41L9.25,5.35C8.66,5.59,8.12,5.92,7.63,6.29L5.24,5.33c-0.22-0.08-0.47,0-0.59,0.22L2.74,8.87 C2.62,9.08,2.66,9.34,2.86,9.48l2.03,1.58C4.84,11.36,4.8,11.69,4.8,12s0.02,0.64,0.07,0.94l-2.03,1.58 c-0.18,0.14-0.23,0.41-0.12,0.61l1.92,3.32c0.12,0.22,0.37,0.29,0.59,0.22l2.39-0.96c0.5,0.38,1.03,0.7,1.62,0.94l0.36,2.54 c0.05,0.24,0.24,0.41,0.48,0.41h3.84c0.24,0,0.44-0.17,0.47-0.41l0.36-2.54c0.59-0.24,1.13-0.56,1.62-0.94l2.39,0.96 c0.22,0.08,0.47,0,0.59-0.22l1.92-3.32c0.12-0.22,0.07-0.47-0.12-0.61L19.14,12.94z M12,15.6c-1.98,0-3.6-1.62-3.6-3.6 s1.62-3.6,3.6-3.6s3.6,1.62,3.6,3.6S13.98,15.6,12,15.6z"/></svg>
        </div>
      </div>
    </div>
    <div id="conversations-container">
      <div id="current-conversation" class="conversation active">
        <div id="chat-container" class="neuro-inset">
          <!-- Chat bubbles will be dynamically added here -->
        </div>
      </div>
      <div id="previous-conversations" class="conversation">
        <!-- Previous conversations will be dynamically added here -->
      </div>
    </div>
    <div id="input-container" class="neuro-box">
      <button id="role-btn" class="neuro-box">User</button>
      <input type="text" id="user-input" class="neuro-inset" placeholder="Type your message...">
      <div id="prompt-dropdown" class="prompt-dropdown neuro-box"></div>
      <button id="send-btn" class="neuro-box">Send</button>
      <button id="save-prompt-btn" class="neuro-box" style="display: none;">Save Prompt</button>
    </div>
  </div>

  <div id="settings-modal" class="neuro-box">
    <div class="modal-content">
      <span class="close">&times;</span>
      <h2>Settings</h2>
      <form class="settings-form">
        <label for="api-base-url">API Base URL:</label>
        <input type="text" id="api-base-url" name="api-base-url" placeholder="https://api.openai.com">
        
        <label for="api-key">OpenAI API Key:</label>
        <input type="password" id="api-key" name="api-key" required>
        
        <label for="model-select">Select Model:</label>
        <select id="model-select" name="model-select">
          <option value="gpt-4o-mini">gpt-4o-mini</option>
          <option value="gpt-4o">gpt-4o</option>
          <option value="gemma2-9b-it">gemma2-9b-it</option>
        </select>
        
        <button type="submit">Save Settings</button>
      </form>
    </div>
  </div>

  <svg style="display: none;">
    <symbol id="delete-icon" viewBox="0 0 24 24">
      <path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"/>
    </symbol>
    <symbol id="rename-icon" viewBox="0 0 24 24">
      <path d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"/>
    </symbol>
  </svg>

  <script>
    const DEFAULT_SYSTEM_PROMPT = "Act as a highly-intellectual assistant. You are an 18 years old female assistant named Ann. You are highly knowledgeable and are tasked to assist with anything informative a user asks from you. Maintain your tone mimicking an 18-year-old teenager.";
    const chatContainer = document.getElementById('chat-container');
    const userInput = document.getElementById('user-input');
    const sendBtn = document.getElementById('send-btn');
    const roleBtn = document.getElementById('role-btn');
    const settingsBtn = document.getElementById('settings-btn');
    const settingsModal = document.getElementById('settings-modal');
    const closeBtn = document.getElementsByClassName('close')[0];
    const settingsForm = document.querySelector('.settings-form');
    const homeBtn = document.getElementById('home-btn');
    const newConversationBtn = document.getElementById('new-conversation-btn');
    const currentTab = document.getElementById('current-tab');
    const previousTab = document.getElementById('previous-tab');
    const currentConversation = document.getElementById('current-conversation');
    const previousConversations = document.getElementById('previous-conversations');
    const clearConversationBtn = document.getElementById('clear-conversation-btn');
    const savePromptBtn = document.getElementById('save-prompt-btn');
    const promptDropdown = document.getElementById('prompt-dropdown');

    let currentRole = 'user';
    const roles = ['user', 'assistant', 'system'];
    let apiKey = '';
    let apiBaseUrl = 'https://api.openai.com';
    let selectedModel = 'gpt-4o-mini';
    let temperature = 0.7;
    const MAX_MESSAGES = 15;
    let conversations = [];
    let currentConversationId = null;
    let savedPrompts = {};

    roleBtn.addEventListener('click', () => {
      const currentIndex = roles.indexOf(currentRole);
      currentRole = roles[(currentIndex + 1) % roles.length];
      roleBtn.textContent = currentRole.charAt(0).toUpperCase() + currentRole.slice(1);
      
      if (currentRole === 'system') {
        savePromptBtn.style.display = 'inline-block';
      } else {
        savePromptBtn.style.display = 'none';
      }
    });

    savePromptBtn.addEventListener('click', () => {
      const promptName = prompt("Enter a name for this prompt:");
      if (promptName && userInput.value.trim() !== '') {
        savedPrompts[promptName] = userInput.value;
        alert(`Prompt "${promptName}" saved!`);
      }
    });

    userInput.addEventListener('input', () => {
      if (userInput.value.startsWith('/')) {
        const promptStart = userInput.value.slice(1);
        const matchingPrompts = Object.keys(savedPrompts).filter(name => 
          name.toLowerCase().startsWith(promptStart.toLowerCase())
        );
        
        if (matchingPrompts.length > 0) {
          promptDropdown.innerHTML = '';
          matchingPrompts.forEach(name => {
            const option = document.createElement('div');
            option.textContent = name;
            option.addEventListener('click', () => {
              userInput.value = savedPrompts[name];
              promptDropdown.style.display = 'none';
            });
            promptDropdown.appendChild(option);
          });
          promptDropdown.style.display = 'block';
        } else {
          promptDropdown.style.display = 'none';
        }
      } else {
        promptDropdown.style.display = 'none';
      }
    });

    document.addEventListener('click', (event) => {
      if (!event.target.matches('#user-input') && !event.target.matches('.prompt-dropdown div')) {
        promptDropdown.style.display = 'none';
      }
    });

    sendBtn.addEventListener('click', sendMessage);
    userInput.addEventListener('keypress', (e) => {
      if (e.key === 'Enter') {
        sendMessage();
      }
    });

    settingsBtn.addEventListener('click', () => {
      settingsModal.style.display = 'block';
    });

    closeBtn.addEventListener('click', () => {
      settingsModal.style.display = 'none';
    });

    window.addEventListener('click', (event) => {
      if (event.target == settingsModal) {
        settingsModal.style.display = 'none';
      }
    });

    settingsForm.addEventListener('submit', (e) => {
      e.preventDefault();
      apiKey = document.getElementById('api-key').value;
      selectedModel = document.getElementById('model-select').value;
      apiBaseUrl = document.getElementById('api-base-url').value || 'https://api.openai.com';
      settingsModal.style.display = 'none';
      addMessage(`Settings saved. Using model: ${selectedModel}, Temperature: ${temperature}, API Base URL: ${apiBaseUrl}`, 'system');
    });

    newConversationBtn.addEventListener('click', createNewConversation);
    currentTab.addEventListener('click', switchToCurrentTab);
    previousTab.addEventListener('click', switchToPreviousTab);
    clearConversationBtn.addEventListener('click', clearConversation);

    function createNewConversation() {
      const conversationId = Date.now();
      const conversation = {
        id: conversationId,
        name: null,
        messages: [
          { content: DEFAULT_SYSTEM_PROMPT, sender: 'system' }
        ]
      };
      conversations.push(conversation);
      currentConversationId = conversationId;
      chatContainer.innerHTML = '';
      addMessage("New conversation started!", 'system');
      updatePreviousConversations();
    }

    function updatePreviousConversations() {
      previousConversations.innerHTML = '';
      conversations.forEach(conversation => {
        if (conversation.id !== currentConversationId) {
          const item = document.createElement('div');
          item.classList.add('previous-conversation-item', 'neuro-box');
          
          const textSpan = document.createElement('span');
          textSpan.textContent = conversation.name || `Conversation ${new Date(conversation.id).toLocaleString()}`;
          item.appendChild(textSpan);
          
          const renameIcon = document.createElement('span');
          renameIcon.classList.add('rename-icon');
          renameIcon.innerHTML = '<svg><use href="#rename-icon" /></svg>';
          renameIcon.addEventListener('click', (e) => {
            e.stopPropagation();
            renameConversation(conversation.id);
          });
          item.appendChild(renameIcon);
          
          const deleteIcon = document.createElement('span');
          deleteIcon.classList.add('delete-icon');
          deleteIcon.innerHTML = '<svg><use href="#delete-icon" /></svg>';
          deleteIcon.addEventListener('click', (e) => {
            e.stopPropagation();
            deleteConversation(conversation.id);
          });
          item.appendChild(deleteIcon);
          
          item.addEventListener('click', () => loadConversation(conversation.id));
          previousConversations.appendChild(item);
        }
      });
    }

    function renameConversation(conversationId) {
      const conversation = conversations.find(c => c.id === conversationId);
      const newName = prompt("Enter a new name for this conversation:", conversation.name || `Conversation ${new Date(conversation.id).toLocaleString()}`);
      if (newName !== null && newName.trim() !== '') {
        conversation.name = newName.trim();
        updatePreviousConversations();
      }
    }

    function deleteConversation(conversationId) {
      conversations = conversations.filter(c => c.id !== conversationId);
      updatePreviousConversations();
    }

    function loadConversation(conversationId) {
      currentConversationId = conversationId;
      const conversation = conversations.find(c => c.id === conversationId);
      chatContainer.innerHTML = '';
      conversation.messages.forEach(msg => addMessage(msg.content, msg.sender));
      switchToCurrentTab();
    }

    function switchToCurrentTab() {
      currentTab.classList.add('active');
      previousTab.classList.remove('active');
      currentConversation.classList.add('active');
      previousConversations.classList.remove('active');
    }

    function switchToPreviousTab() {
      currentTab.classList.remove('active');
      previousTab.classList.add('active');
      currentConversation.classList.remove('active');
      previousConversations.classList.add('active');
    }

    function clearConversation() {
      chatContainer.innerHTML = '';
      if (currentConversationId) {
        const conversation = conversations.find(c => c.id === currentConversationId);
        conversation.messages = [];
      }
      addMessage("Conversation cleared.", 'system');
    }

    async function sendMessage() {
      if (!currentConversationId) {
        createNewConversation();
      }
      const message = userInput.value;
      if (message.trim() !== '') {
        addMessage(message, currentRole);
        userInput.value = '';
        
        if (apiKey) {
          try {
            const conversation = conversations.find(c => c.id === currentConversationId);
            const recentMessages = conversation.messages.slice(-MAX_MESSAGES);
            
            const messagesForAPI = [
              { role: 'system', content: DEFAULT_SYSTEM_PROMPT },
              ...recentMessages.map(msg => ({role: msg.sender, content: msg.content}))
            ];
            
            const response = await fetch(`${apiBaseUrl}/v1/chat/completions`, {
              method: 'POST',
              headers: {
                'Content-Type': 'application/json',
                'Authorization': `Bearer ${apiKey}`
              },
              body: JSON.stringify({
                model: selectedModel,
                messages: messagesForAPI,
                max_tokens: 4096,
                temperature: temperature
              })
            });
            
            const data = await response.json();
            if (data.choices && data.choices.length > 0) {
              addMessage(data.choices[0].message.content, 'assistant');
            } else {
              addMessage("I'm sorry, I couldn't generate a response. Please try again.", 'assistant');
            }
          } catch (error) {
            addMessage("There was an error communicating with the OpenAI API. Please check your API key and try again.", 'system');
          }
        } else {
          addMessage("Please set your OpenAI API key in the settings before sending messages.", 'system');
        }
      }
    }

    function copyToClipboard(text) {
      navigator.clipboard.writeText(text).then(() => {
        alert('Copied to clipboard!');
      }).catch(err => {
        console.error('Failed to copy: ', err);
      });
    }

    function addMessage(content, sender) {
      const bubble = document.createElement('div');
      bubble.classList.add('chat-bubble', sender + '-bubble', 'neuro-box');
      
      const header = document.createElement('div');
      header.classList.add('chat-header');
      
      const icon = document.createElement('div');
      icon.classList.add('chat-icon');
      icon.style.backgroundImage = `url('https://api.dicebear.com/6.x/initials/svg?seed=${sender}')`;
      
      const name = document.createElement('div');
      name.classList.add('chat-name');
      name.textContent = sender.charAt(0).toUpperCase() + sender.slice(1);
      
      header.appendChild(icon);
      header.appendChild(name);
      
      const messageContent = document.createElement('div');
      messageContent.classList.add('message-content');
      messageContent.innerHTML = marked.parse(content); // Parse markdown content
      
      const copyIcon = document.createElement('div');
      copyIcon.classList.add('copy-icon');
      copyIcon.innerHTML = '<svg viewBox="0 0 24 24" width="18" height="18"><path fill="currentColor" d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"/></svg>';
      copyIcon.onclick = () => copyToClipboard(content);

      bubble.appendChild(header);
      bubble.appendChild(messageContent);
      bubble.appendChild(copyIcon);
      
      chatContainer.appendChild(bubble);
      chatContainer.scrollTop = chatContainer.scrollHeight;

      if (currentConversationId) {
        const conversation = conversations.find(c => c.id === currentConversationId);
        conversation.messages.push({ content, sender });
      }
    }

    // Initialize the first conversation
    createNewConversation();
  </script>
</body></html>
